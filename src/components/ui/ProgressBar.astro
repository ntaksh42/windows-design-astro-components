---
/**
 * ProgressBar - Windows Forms風のプログレスバーコンポーネント
 *
 * @param value - 現在の進捗値（0-100）
 * @param variant - スタイルバリアント（'default' | 'indeterminate'）
 * @param orientation - 向き（'horizontal' | 'vertical'）
 * @param height - バーの高さ（横向きの場合）
 * @param width - バーの幅
 */
interface Props {
  value?: number;
  variant?: 'default' | 'indeterminate';
  orientation?: 'horizontal' | 'vertical';
  height?: string;
  width?: string;
}

const {
  value = 0,
  variant = 'default',
  orientation = 'horizontal',
  height = '23px',
  width = '200px',
} = Astro.props;

const clampedValue = Math.min(100, Math.max(0, value));
---

<div
  class={`progress-bar ${variant} ${orientation}`}
  style={`--progress-value: ${clampedValue}%; --height: ${height}; --width: ${width};`}
  role="progressbar"
  aria-valuenow={variant === 'default' ? clampedValue : undefined}
  aria-valuemin="0"
  aria-valuemax="100"
>
  <div class="progress-fill"></div>
</div>

<style>
  .progress-bar {
    background: linear-gradient(to bottom, #ffffff, #f0f0f0);
    border: 1px solid #7f7f7f;
    border-radius: 2px;
    box-shadow:
      inset 0 1px 3px rgba(0, 0, 0, 0.1),
      0 1px 0 rgba(255, 255, 255, 0.3);
    overflow: hidden;
    position: relative;
  }

  .progress-bar.horizontal {
    width: var(--width);
    height: var(--height);
  }

  .progress-bar.vertical {
    width: var(--height);
    height: var(--width);
  }

  .progress-fill {
    background: linear-gradient(
      to bottom,
      #06b025,
      #05a021
    );
    height: 100%;
    transition: width 0.3s ease;
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.3);
  }

  .horizontal .progress-fill {
    width: var(--progress-value);
  }

  .vertical .progress-fill {
    position: absolute;
    bottom: 0;
    width: 100%;
    height: var(--progress-value);
  }

  /* 不確定アニメーション */
  .indeterminate .progress-fill {
    width: 30%;
    animation: indeterminate 1.5s ease-in-out infinite;
  }

  .indeterminate.vertical .progress-fill {
    width: 100%;
    height: 30%;
    animation: indeterminate-vertical 1.5s ease-in-out infinite;
  }

  @keyframes indeterminate {
    0% {
      transform: translateX(-100%);
    }
    50% {
      transform: translateX(0%);
    }
    100% {
      transform: translateX(333%);
    }
  }

  @keyframes indeterminate-vertical {
    0% {
      transform: translateY(333%);
    }
    50% {
      transform: translateY(0%);
    }
    100% {
      transform: translateY(-100%);
    }
  }
</style>
