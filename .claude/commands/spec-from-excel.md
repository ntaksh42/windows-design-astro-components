---
description: Excelメモから PC アプリ風の外部仕様書を自動生成
---

ユーザーから以下の情報を収集してください：

1. **Excelファイルのパス**: 仕様メモが記載されたExcelファイル（例: `./specs/DatePicker.xlsx`, `./requirements.csv`）
2. **シート名**（オプション）: 複数シートがある場合、どのシートを使うか（省略時は最初のシート）

## Excelファイルの確認

まず、Excelファイルの存在と形式を確認してください：

```bash
# ファイルの確認
ls -la <Excelファイルパス>

# 可能であれば、Excelの内容をプレビュー
# （Readツールで読めるか試す、ただしバイナリなので読めない可能性が高い）
```

## コマンド実行

情報を収集したら、以下のコマンドを実行してください：

```bash
npm run spec:from-excel "<Excelファイルパス>" [シート名]
```

例:
```bash
# 基本的な使い方
npm run spec:from-excel "./specs/DatePicker.xlsx"

# シート名を指定
npm run spec:from-excel "./specs/components.xlsx" "DatePicker"

# CSVファイルから
npm run spec:from-excel "./requirements.csv"
```

## Excelフォーマットについて

ユーザーに以下のフォーマット例を提示してください：

### 縦型フォーマット（推奨）

| 項目 | 値 |
|------|-----|
| コンポーネント名 | DatePicker |
| 説明 | 日付選択コンポーネント、カレンダーUI付き |
| カテゴリー | form |
| **## プロパティ** | |
| minDate | Date | 2000-01-01 | 最小日付 |
| maxDate | Date | 2100-12-31 | 最大日付 |
| format | string | YYYY-MM-DD | 日付フォーマット |
| **## 機能** | |
| 機能1 | カレンダーUIでの日付選択 |
| 機能2 | キーボード入力にも対応 |
| **## 使用例** | |
| 例1 | <DatePicker minDate="2024-01-01" /> |
| **## 備考** | |
| 備考 | IEは非対応です |

### 横型フォーマット

| コンポーネント名 | 説明 | カテゴリー | プロパティ1 | プロパティ2 |
|----------------|------|-----------|------------|------------|
| DatePicker | 日付選択 | form | minDate:Date | maxDate:Date |

## 実行後の手順

1. **生成された仕様書を確認**
   - ファイル: `src/pages/<コンポーネント名>-demo.mdx`
   - 内容をReadツールで読み取り、レビュー

2. **生成内容をユーザーに報告**
   - 生成された仕様書のパスを伝える
   - Excelから抽出した情報（コンポーネント名、プロパティ数等）を報告
   - 主要なセクションの内容を簡単に要約

3. **必要に応じて修正を支援**
   - ユーザーが内容を確認し、修正が必要な場合は支援

## エラー処理

以下のエラーが発生した場合の対処法：

### "ファイルが見つかりません"
- ファイルパスが正しいか確認
- 相対パスと絶対パスを試す
- `ls`コマンドでファイルの存在を確認

### "コンポーネント名が見つかりませんでした"
- Excelに「コンポーネント名」「Name」「Component」のいずれかの項目があるか確認
- フォーマットが正しいか確認
- ユーザーにExcelの内容を見せてもらい、フォーマットを修正

### "シートが見つかりません"
- シート名が正しいか確認
- シート名を省略して最初のシートを使用

## 重要な注意事項

- Excelファイルは .xlsx, .xls, .csv に対応
- 日本語と英語の両方のヘッダーに対応
- プロパティや機能が多い場合でも自動的に整理される
- Claude APIキーがあれば、より高品質な仕様書が生成される（なくても動作）

## サポートするExcelの配置パターン

1. **プロジェクトルートに配置**: `./spec.xlsx`
2. **specsフォルダに配置**: `./specs/DatePicker.xlsx`
3. **任意の場所**: 絶対パスで指定

必要に応じて、ユーザーにExcelファイルの配置場所を提案してください。
